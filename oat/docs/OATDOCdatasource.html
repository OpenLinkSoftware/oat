<html>
<head>
    <title>OpenLink AJAX Toolkit</title>
    <link rel="STYLESHEET" type="text/css" href="oat.css"/>
  </head>

<body>
  <div class="topic-text">
    

    <div id="oatnav">
        <a href="index.html">Index</a> | 
      <a href="http://oat.openlinksw.com/" target="_new">OAT homepage</a> | 
      <a href="http://www.openlinksw.com/" target="_new">OpenLink Software</a>
      </div>

    
    

    <h2>datasource.js</h2>

    <p>Provides data access support for various data sources
    (SQL,SPARQL,SOAP...) and allows binding and execution of
    callbacks upon data arrival. Data are fetched on demand and
    cached.</p>

    <div class="wikitoc">
      <ul>
        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
        <a href="#datasource.js">datasource.js</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#Objects">Objects</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource(type)">OAT.DataSource(type)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#Properties">Properties</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::connection">OAT.DataSource::connection</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::options">OAT.DataSource::options</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::outputFields">OAT.DataSource::outputFields</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#Methods">Methods</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::bindRecord(recordCallback)">OAT.DataSource::bindRecord(recordCallback)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::bindPage(pageCallback)">OAT.DataSource::bindPage(pageCallback)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::bindFile(fileCallback)">OAT.DataSource::bindFile(fileCallback)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::bindEmpty(emptyCallback)">OAT.DataSource::bindEmpty(emptyCallback)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::bindHeader(headerCallback)">OAT.DataSource::bindHeader(headerCallback)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSource::advanceRecord(recordIndex)">OAT.DataSource::advanceRecord(recordIndex)</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#Constants">Constants</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSourceData.TYPE_SQL">OAT.DataSourceData.TYPE_SQL</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSourceData.TYPE_SOAP">OAT.DataSourceData.TYPE_SOAP</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSourceData.TYPE_REST">OAT.DataSourceData.TYPE_REST</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSourceData.TYPE_SPARQL">OAT.DataSourceData.TYPE_SPARQL</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#OAT.DataSourceData.TYPE_GDATA">OAT.DataSourceData.TYPE_GDATA</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#Examples">Examples</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#REST%20Example">REST
        Example</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#SQL%20Example">SQL
        Example</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#SPARQL%20Example">SPARQL
        Example</a>
          </li>

        <li>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label>
            <label class="c2">_</label> <a href="#GData%20Example">GData
        Example</a>
          </li>
      </ul>
    </div>

    <h3> Objects</h3>

    <h4>OAT.DataSource(type)</h4>Creates new
    DataSource? object. type is one of type constants.

    <h3> Properties</h3>

    <h4>OAT.DataSource::connection</h4>Assigns
    an OAT.Connection object to this datasource.

    <h4>OAT.DataSource::options</h4>

    <p>Object with various properties, dependent on
    DataSource? Type:</p>

    <ul>
      <li>TYPE_SQL

        <ul>
          <li>query - SQL query</li>

          <li>limit - cursor limit</li>

          <li>cursortype - 0/1; 0 - snapshot, 1 - dynaset</li>
        </ul>
      </li>

      <li>TYPE_SOAP

        <ul>
          <li>service - name of WSDL service</li>

          <li>rootelement - name of root input WSDL element</li>

          <li>inputobj - input WSDL object (see ws.js documentation
          for details)</li>
        </ul>
      </li>

      <li>TYPE_REST, TYPE_SPARQL, TYPE_GDATA

        <ul>
          <li>query - HTTP GET querystring</li>

          <li>output - 0/1; 0 - xml, 1 = json</li>

          <li>xpath - bool; are outputFields specified as XPath
          expressions, or as node names?</li>
        </ul>
      </li>
    </ul>

    <h4>OAT.DataSource::outputFields</h4>List
    of wanted fields in fetched data.

    <h3> Methods</h3>

    <h4>OAT.DataSource::bindRecord(recordCallback)</h4>Listens
    for new data records. When new record is available,
    recordCallback is executed with 2 arguments: record data and
    record index.

    <h4>OAT.DataSource::bindPage(pageCallback)</h4>Listens
    for new data record pages. When new data page (record set) is
    available, pageCallback is executed with 2 arguments: page data
    and page index.

    <h4>OAT.DataSource::bindFile(fileCallback)</h4>Listens
    for new data file. When new data file is available,
    fileCallback is executed with 1 argument: file contents.

    <h4>OAT.DataSource::bindEmpty(emptyCallback)</h4>Listens
    for empty dataset. When empty dataset arrives, emptyCallback is
    executed.

    <h4>OAT.DataSource::bindHeader(headerCallback)</h4>Listens
    for data header. When header arrives, headerCallback is
    executed with 1 argument: data header.

    <h4>OAT.DataSource::advanceRecord(recordIndex)</h4>Advanced
    through records. recordIndex can be an integer or "-1" or "+1".

    <h3> Constants</h3>

    <h4>
    OAT.DataSourceData.TYPE_SQL</h4>

    <h4>
    OAT.DataSourceData.TYPE_SOAP</h4>

    <h4>
    OAT.DataSourceData.TYPE_REST</h4>

    <h4>
    OAT.DataSourceData.TYPE_SPARQL</h4>

    <h4>
    OAT.DataSourceData.TYPE_GDATA</h4>

    <h3> Examples</h3>

    <h4> REST Example</h4>
      <br/>
    <pre>
var conn = new OAT.Connection(OAT.ConnectionData.TYPE_REST, {url:"myfile.xml"});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_REST);
ds.connection = conn;
ds.options.output = 0; /* fetch result as XML */
ds.options.xpath = 1; /* outputFields are specified as XPATH expressions */
ds.outputFields = ['//result/binding[@name="created"]/node()/text()',
                                        '//result/binding[@name="creator"]/node()/text()',
                                        '//result/binding[@name="item_title"]/node()/text()',
                                        '//result/binding[@name="url"]/node()/text()'];

var recordCallback = function(data, index) {
        alert('Data at index ' + index + ':\n' + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre>

    <h4> SQL Example</h4>
      <br/>
    <pre>
var conn = new OAT.Connection(OAT.ConnectionData.TYPE_XMLA, {dsn:"DSN=Local_Instance",endpoint:"/XMLA"});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_SQL);
ds.connection = conn;
ds.options.query = "SELECT OrderID, CustomerID, EmployeeID FROM Demo.demo.Orders";

var recordCallback = function(data, index) {
        alert('Data at index ' + index + ':\n' + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre>

    <h4> SPARQL Example</h4>
      <br/>
    <pre>
var connection = new OAT.Connection(OAT.ConnectionData.TYPE_REST,{url:"/sparql/"});
var q = "SELECT ?s, ?p, ?o FROM &lt;http://www.flickr.com/search/?q=rdf+semanticweb&amp;s=rec&gt; WHERE { ?s ?p ?o . }";

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_SPARQL);
ds.outputFields = ['//result/binding[@name="s"]/node()/text()',
   '//result/binding[@name="p"]/node()/text()',
   '//result/binding[@name="o"]/node()/text()'];

ds.connection = connection;
ds.options.query = "query="+encodeURIComponent(q)+"&amp;format=xml";
ds.options.output = 0; /* fetch result as XML */
ds.options.xpath = 1; /* outputFields are specified as XPATH expressions */

var recordCallback = function(data, index) {
        alert('Data at index ' + index + ':\n' + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre>

    <h4> GData Example</h4>
      <br/>
    <pre>
var conn = new OAT.Connection(OAT.ConnectionData.TYPE_REST, {url:"gdata.xml"});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_GDATA);
ds.connection = conn;
ds.options.output = 0;
ds.options.xpath = 1;
ds.outputFields = [ "//atom:feed/atom:entry/atom:title" ];

var recordCallback = function(data, index) {
        alert('Data at index ' + index + ':\n' + data );
}

ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre>

    
    

    <div id="oatcopy">
      Copyright (C) 
      <a href="http://www.openlinksw.com/">OpenLink Software</a> 
      2005-2008
    </div>
  </div>
</body>
</html>
